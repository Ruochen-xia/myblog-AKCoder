# 20251222 - 强连通分量

## 前言：

Tarjan 爷爷太**巨**了！！！

## DFS 生成树（OI-WIKI的）

![img](data:image/png;base64,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)

在**有向图**中，DFS生成树有4种边：

1. 树边，黑色实线，从父节点指向还没有被访问的子节点。

2. 返祖边，红色虚线，指向祖先节点的边。

3. 前向边，绿色虚线，指向子树中的边。（没啥用）

4. 横叉边，蓝色虚线，指向已经访问过的，不是祖先节点也不是子树中的边。

## SCC（强连通分量）

**有向图**中，如果一个图满足任意两点之间都可达，那么我们就称它是**强连通**的。

可以定义 $low_u$ 为 $u$ 号点可以到的最小时间戳（DFN），可以发现，如果 $low_u = dfn_u$，就可以构成一个强连通分量，因为他无法再向上走了。

但是有一个问题，如果有没有用的横叉边不就凉凉了，$low_u$ 会不知道更新到哪去！

如果 $u$ 存在于 SCC 中，当且仅当这个点访问过并在栈中，这样的才有用。

所以代码很好写：

```cpp
inline void Tarjan(int u) { // inline 有什么作用呢？？？
  dfn[u] = low[u] = ++idx; 
  stk[++top] = u; // 手写栈
  ins[u] = 1; // 是否在栈中
  for (auto v : edges[u]) {
    if (!dfn[v]) {
      Tarjan(v);
      low[u] = min(low[u], low[v]);
    }else if (ins[v]){
      low[u] = min(low[u], dfn[v]); // 为什么是 dfn[v] 呢？
    } // 因为它只能走一条返祖边！！！
  }
  if (low[u] == dfn[u]) {
    vector <int> ve;
    while (1) {
      int v = stk[top--];
      ins[v] = 0;
      ve.push_back(v);
      if (v == u) break; 
    }
    scc.push_back(ve);
  }
}
```

## 缩点

缩点，就是把一个 SCC 缩成一个点，把他变成 DAG，这样~~**想干啥就干啥**~~就可以进行 dp 了！

把不同的 SCC 来建边，这样~~**想干啥就干啥**~~。

代码（Tarjan 代码省略）：

```cpp
void solve() {
    for (int i = 1; i <= n; i++) {
        for (auto v : edges[i]) {
            if (bel[i] != bel[v]) {
                G[bel[i]].push_back(bel[v]);
            }
        }
    }
}
```

## 边双连通分量

**无向图**中，如果任意删去一边之后任意两点之间还可达，那么我们就称它是**边双连通**的。

边双连通其实把 $Tarjan$ 的有向边换成无向边就可以了。

> 注意：重边！！！

代码：

```cpp
inline void Tarjan(int u, int from) {
  dfn[u] = low[u] = ++idx; 
  stk[++top] = u;
  ins[u] = 1;
  int mark = 0;
  for (auto v : edges[u]) {
    if (v == from && !mark) {
      mark = 1;
    } else if (!dfn[v]) {
      Tarjan(v, u);
      low[u] = min(low[u], low[v]);
    }else if (ins[v]){
      low[u] = min(low[u], dfn[v]);
    }
  }
  if (low[u] == dfn[u]) {
    vector <int> ve;
    while (1) {
      int v = stk[top--];
      ins[v] = 0;
      ve.push_back(v);
      if (v == u) break; 
    }
    scc.push_back(ve);
  }
}
```

相同颜色的点为同一个连通分量！！！

![img](https://cdn.vjudge.net.cn/e9cb86b971b8080da665da3fa02e3b33)



# 后记

今天，我询问 [Joler](https://vjudge.net/user/Joler) 老师：“什么时候要用点双，什么时候要用边双？”，[Joler](https://vjudge.net/user/Joler) 老师笑而答曰：“请听下回分解（下节课再讲）”。

